// DIE's signature file

init("compiler","Borland C++");

var bBorlandC; // let "Borland Delphi.3" know

function detect(bShowType,bShowVersion,bShowOptions)
{
    if(PE.compare("'MZ'50000200000004000F00FFFF0000B80000000000000040001A00000000000000000000000000000000000000000000000000000000000000000000020000BA10000E1FB409CD21B8014CCD219090'This program must be run under Win32\r\n$'370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'PE'0000"))
    {
        bDetected=1;
    }
    else if(PE.compareEP("A1........C1E002A3"))
    {
        bDetected=1;
    }
    else if(PE.compareEP("EB10'fb:C++HOOK'90"))
    {
        sVersion="1999";
        bDetected=1;
    }
    else if(PE.section.length>1)
    {
        var nOffset=PE.section[1].FileOffset;
        var nSize=Math.min(1024,PE.section[1].FileSize);
        if(PE.isSignaturePresent(nOffset,nSize,"'Borland C++ - Copyright'"))
        {
            bDetected=1;
        }
    }

    if(bDetected)
    {
        if(PE.isResourceNamePresent("PACKAGEINFO")||PE.isResourceNamePresent("DVCLAL"))
        {
            sVersion="Builder";
        }
        bBorlandC=1;
    }

    return result(bShowType,bShowVersion,bShowOptions);
}
